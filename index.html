<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multi-Asset Price Estimator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <style>
    :root {
      --tron-blue: #ffffff;
      --tron-dark: #000000;
      --tron-gray: #1a1a1a;
      --tron-border: #333333;
      --long-color: #00ff88;
      --short-color: #ff5555;
      --loss-color: #ff9900;
      --gradient-1: linear-gradient(45deg, #ffffff, #e0e0e0);
      --gradient-2: linear-gradient(45deg, #ffffff, #f0f0f0);
      --glow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    body { 
      background-color: var(--tron-dark); 
      color: #ffffff; 
      padding: 20px; 
      font-family: 'Share Tech Mono', monospace;
      min-height: 100vh;
    }

    h1 {
      font-family: 'Orbitron', sans-serif;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 2rem;
      background: var(--gradient-1);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: var(--glow);
    }

    .form-label {
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      background: var(--gradient-2);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 0.5rem;
    }

    .form-control {
      background-color: var(--tron-gray);
      border: 1px solid var(--tron-border);
      color: #ffffff;
      font-family: 'Share Tech Mono', monospace;
      padding: 0.75rem;
      transition: all 0.3s ease;
      border-radius: 0;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
    }

    .form-control:focus {
      background-color: var(--tron-gray);
      border-color: #ffffff;
      color: #ffffff;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
    }

    .btn-group .btn {
      background-color: var(--tron-gray);
      border: 1px solid var(--tron-border);
      color: #ffffff;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 1px;
      padding: 0.5rem 1rem;
      margin-right: 5px;
      transition: all 0.3s ease;
      border-radius: 0;
    }

    .btn-group .btn:hover {
      background: var(--gradient-1);
      color: var(--tron-dark);
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
    }

    .btn-group .btn.active {
      background: var(--gradient-1);
      color: var(--tron-dark);
      border-color: #ffffff;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
    }

    .price-container {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 0.5rem 0;
      padding: 0.5rem;
      background-color: var(--tron-gray);
      border: 1px solid var(--tron-border);
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.05);
    }

    .copy-btn {
      padding: 2px 8px;
      font-size: 0.8rem;
      background-color: var(--tron-gray);
      border: 1px solid #ffffff;
      color: #ffffff;
      cursor: pointer;
      font-family: 'Share Tech Mono', monospace;
      transition: all 0.3s ease;
      border-radius: 0;
    }

    .copy-btn:hover {
      background: var(--gradient-1);
      color: var(--tron-dark);
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    }

    #result, #resultSell, #stopLossResult {
      font-size: 1rem;
      font-weight: normal;
      margin-top: 1rem;
      font-family: 'Share Tech Mono', monospace;
    }

    .buy-result { color: var(--long-color); }
    .sell-result { color: var(--short-color); }
    .loss-result { color: var(--loss-color); }

    #tv-widget iframe, #price-ticker iframe {
      width: 100%;
      border: none;
      margin-bottom: 1rem;
    }

    #tv-widget iframe { height: 100px; }
    #price-ticker iframe { height: 50px; }

    fieldset {
      border: 1px solid var(--tron-border);
      padding: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.05);
    }

    legend {
      font-family: 'Orbitron', sans-serif;
      background: var(--gradient-2);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      padding: 0 0.5rem;
    }

    .input-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .input-grid .form-group {
      margin-bottom: 0;
    }
  </style>
</head>
<body>
  <div class="mb-2" id="price-ticker-container"><div id="price-ticker"></div></div>
  <div class="mb-4"><div id="tv-widget"></div></div>
  <h1>Price Estimator</h1>
  <fieldset class="mb-4">
    <legend>Select Asset:</legend>
    <div class="btn-group" role="group">
      <button class="btn btn-outline-light active" onclick="selectSymbol('xauusd', event)">XAUUSD</button>
      <button class="btn btn-outline-light" onclick="selectSymbol('solusd', event)">SOLUSD</button>
      <button class="btn btn-outline-light" onclick="selectSymbol('spx500', event)">SPX500</button>
    </div>
  </fieldset>

  <input type="hidden" id="symbol" value="xauusd">
  <div class="mb-3">
    <label for="balance" class="form-label">Account Balance (USD)</label>
    <input type="number" class="form-control" id="balance" value="1000" step="10" min="0">
  </div>

  <div class="input-grid">
    <div class="form-group">
      <label for="entry" class="form-label">Entry Price</label>
      <input type="number" class="form-control" id="entry" step="0.01" value="0">
    </div>
    <div class="form-group">
      <label for="lot" class="form-label">Lot Size</label>
      <input type="number" class="form-control" id="lot" step="0.01" value="0.05" min="0.01">
    </div>
  </div>

  <div class="input-grid">
    <div class="form-group">
      <label for="targetReturn" class="form-label">Target Profit (%)</label>
      <input type="number" class="form-control" id="targetReturn" value="5" step="0.1" min="0">
    </div>
    <div class="form-group">
      <label for="stopLossPercent" class="form-label">Stop Loss (%)</label>
      <input type="number" class="form-control" id="stopLossPercent" value="10" step="0.1" min="0">
    </div>
  </div>

  <p id="result" class="buy-result">Long Position: --</p>
  <p id="resultSell" class="sell-result">Short Position: --</p>
  <p id="stopLossResult" class="loss-result">Stop Loss: --</p>

  <script>
    const tradingViewSymbols = { 
      xauusd: 'OANDA:XAUUSD', 
      solusd: 'BINANCE:SOLUSDT', 
      spx500: 'OANDA:SPX500USD',
      btcusd: 'BINANCE:BTCUSDT',
      ethusd: 'BINANCE:ETHUSDT',
      nasdaq: 'NASDAQ:NDX',
      dow: 'DJ:DJI',
      usdjpy: 'OANDA:USDJPY',
      eurusd: 'OANDA:EURUSD',
      gbpusd: 'OANDA:GBPUSD'
    };

    function loadTradingView(symbolKey) {
      const container = document.getElementById('tv-widget');
      const script = document.createElement('script');
      container.innerHTML = '';
      script.src = 'https://s3.tradingview.com/external-embedding/embed-widget-mini-symbol-overview.js';
      script.type = 'text/javascript';
      script.async = true;
      script.text = JSON.stringify({ symbol: tradingViewSymbols[symbolKey], width: '100%', height: '100', locale: 'en', dateRange: '1D', colorTheme: 'dark', isTransparent: false, autosize: true });
      container.appendChild(script);
    }

    function loadPriceTicker(symbolKey) {
      const container = document.getElementById('price-ticker');
      const script = document.createElement('script');
      container.innerHTML = '';
      script.src = 'https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js';
      script.type = 'text/javascript';
      script.async = true;
      script.text = JSON.stringify({
        symbols: [
          { proName: tradingViewSymbols[symbolKey], title: symbolKey.toUpperCase() },
          { proName: "BINANCE:BTCUSDT", title: "BTC" },
          { proName: "BINANCE:ETHUSDT", title: "ETH" },
          { proName: "NASDAQ:NDX", title: "NASDAQ" },
          { proName: "DJ:DJI", title: "DOW" },
          { proName: "OANDA:EURUSD", title: "EUR/USD" },
          { proName: "OANDA:GBPUSD", title: "GBP/USD" }
        ],
        colorTheme: "dark",
        isTransparent: false,
        displayMode: "adaptive",
        locale: "en",
        showSymbolLogo: true,
        largeChartUrl: ""
      });
      container.appendChild(script);
    }

    function selectSymbol(symbol, e) {
      document.getElementById('symbol').value = symbol;
      document.querySelectorAll('.btn-group .btn').forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      loadTradingView(symbol);
      loadPriceTicker(symbol);
      resetFields(symbol);
      calculateAll();
    }

    function resetFields(symbol) {
      const lotField = document.getElementById('lot');
      lotField.min = symbol === 'xauusd' ? 0.01 : 0.1;
      lotField.step = symbol === 'xauusd' ? 0.01 : 0.1;
      lotField.value = symbol === 'xauusd' ? 0.05 : 0.1;
      document.getElementById('entry').step = symbol === 'spx500' ? 1 : 0.01;
      document.getElementById('entry').value = 0;
    }

    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).catch(err => {
        console.error('複製失敗:', err);
      });
    }

    function calculateAll() {
      const entry = parseFloat(document.getElementById('entry').value) || 0;
      const lot = parseFloat(document.getElementById('lot').value) || 0;
      const balance = parseFloat(document.getElementById('balance').value) || 0;
      const pct = parseFloat(document.getElementById('targetReturn').value) || 0;
      const stopPct = parseFloat(document.getElementById('stopLossPercent').value) || 0;
      const sym = document.getElementById('symbol').value;

      let pipSize = sym === 'spx500' ? 1 : 0.01;
      let pipVal = sym === 'solusd' ? 0.1 : (sym === 'spx500' ? 10 : 1);

      const targetProfit = balance * pct / 100;
      const pipsNeeded = targetProfit / (pipVal * lot);
      const priceDiff = pipsNeeded * pipSize;

      const exitLong = entry + priceDiff;
      const exitShort = entry - priceDiff;

      const stopLossAmount = targetProfit * (stopPct / 100);
      const stopPips = stopLossAmount / (pipVal * lot);
      const stopDiff = stopPips * pipSize;

      const stopLong = entry - stopDiff;
      const stopShort = entry + stopDiff;

      document.getElementById('result').innerHTML = `
        Long Position:
        <div class="price-container">
          <span>Target Exit: ${exitLong.toFixed(2)}</span>
          <button class="copy-btn" onclick="copyToClipboard('${exitLong.toFixed(2)}')">COPY</button>
          <span>| Profit: ${targetProfit.toFixed(2)} USD</span>
        </div>`;

      document.getElementById('resultSell').innerHTML = `
        Short Position:
        <div class="price-container">
          <span>Target Exit: ${exitShort.toFixed(2)}</span>
          <button class="copy-btn" onclick="copyToClipboard('${exitShort.toFixed(2)}')">COPY</button>
          <span>| Profit: ${targetProfit.toFixed(2)} USD</span>
        </div>`;

      document.getElementById('stopLossResult').innerHTML = `
        Stop Loss:
        <div class="price-container">
          <span>Long Stop: ${stopLong.toFixed(2)}</span>
          <button class="copy-btn" onclick="copyToClipboard('${stopLong.toFixed(2)}')">COPY</button>
          <span>| Short Stop: ${stopShort.toFixed(2)}</span>
          <button class="copy-btn" onclick="copyToClipboard('${stopShort.toFixed(2)}')">COPY</button>
          <span>| Loss: ${stopLossAmount.toFixed(2)} USD</span>
        </div>`;
    }

    window.onload = () => {
      ['entry','lot','balance','targetReturn','stopLossPercent'].forEach(id => document.getElementById(id).addEventListener('input', calculateAll));
      selectSymbol('xauusd', { target: document.querySelector('.btn-group .btn') });
    };
  </script>
</body>
</html>
